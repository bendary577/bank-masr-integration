<h3 mat-dialog-title>Update POS Sales Configuartion</h3>


<div>
    <div *ngIf="!loading && syncJobType">

        <!-- Oracle Hospitality Configurations -->
        <mat-expansion-panel *ngIf="accountERD == 'ExportSun'">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Exported File
                </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="container" *ngIf="!loading">
                <form class="my-form">
                    <div>
                        <mat-checkbox id="exportFilePerLocation" name="exportFilePerLocation" class="example-margin" [(ngModel)]="syncJobType.configuration.salesConfiguration.exportFilePerLocation">Export files per location</mat-checkbox> 
                    </div>
                    <br>

                    <div>
                        <mat-form-field class="example-full-width">
                            <input matInput id="recordType" name="recordType" placeholder="Record Type" [(ngModel)]="syncJobType.configuration.salesConfiguration.recordType">
                        </mat-form-field>
                    </div>

                    <div>
                        <mat-form-field class="example-full-width">
                            <input matInput id="conversionCode" name="conversionCode" placeholder="Conversion Code" [(ngModel)]="syncJobType.configuration.salesConfiguration.conversionCode">
                        </mat-form-field>
                    </div>

                    <div>
                        <mat-form-field class="example-full-width">
                            <input matInput id="conversionRate" name="conversionRate" placeholder="Conversion Rate" [(ngModel)]="syncJobType.configuration.salesConfiguration.conversionRate">
                        </mat-form-field>
                    </div>

                    <div>
                        <mat-form-field class="example-full-width">
                            <input matInput id="versionCode" name="versionCode" placeholder="Version Code" [(ngModel)]="syncJobType.configuration.salesConfiguration.versionCode">
                        </mat-form-field>
                    </div>
    
                </form>
            </div>

        </mat-expansion-panel>

        <!-- Oracle Hospitality Configurations -->
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Oracle Hospitality
                </mat-panel-title>
            </mat-expansion-panel-header>
            <app-ohra-configuration [syncJobType]=syncJobType></app-ohra-configuration>
        </mat-expansion-panel>

        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Infor Sun System
                </mat-panel-title>
            </mat-expansion-panel-header>
            <app-infor-system-configuration [syncJobType]=syncJobType></app-infor-system-configuration>
        </mat-expansion-panel>

        <!-- Cash Shortage/Surplus POS Configurations -->
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Cash Shortage/Surplus POS
                </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="container" *ngIf="!loading">
                <form class="my-form">
                    <div>
                        <mat-form-field class="example-full-width">
                            <input matInput id="cashShortagePOS" name="cashShortagePOS" placeholder="Cash Shortage POS Account" [(ngModel)]="syncJobType.configuration.salesConfiguration.cashShortagePOS">
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field class="example-full-width">
                            <input matInput id="cashSurplusPOS" name="cashSurplusPOS" placeholder="Cash Surplus POS Account" [(ngModel)]="syncJobType.configuration.salesConfiguration.cashSurplusPOS">
                        </mat-form-field>
                    </div>

                </form>
            </div>

        </mat-expansion-panel>

        <!-- Tenders Mapping -->
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Tenders Mapping
                </mat-panel-title>
            </mat-expansion-panel-header>

            <app-tender-configuration [tenders]=tenders [syncJobType]=syncJobType></app-tender-configuration>
        </mat-expansion-panel>

        <!-- Taxes Mapping -->
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Taxes Mapping
                </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="back" style="margin-bottom: 15px;">
                <button mat-flat-button (click)="openTaxDialog()">Add</button>
            </div>

            <div>
                <mat-checkbox id="tenderIncludeTax" name="tenderIncludeTax" class="example-margin" [(ngModel)]="syncJobType.configuration.salesConfiguration.taxIncluded">Is tax included</mat-checkbox>
            </div>
            <br>

            <div *ngIf="taxes?.length > 0 && !loading">

                <ngx-datatable class="material" [rows]="taxes" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="50" [scrollbarV]="true" [scrollbarH]="true" [sortType]="'multi'">

                    <ngx-datatable-column name="tax">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <mat-checkbox class="example-margin" [(ngModel)]="row.checked" *ngIf="row.tax">{{row.tax}}</mat-checkbox>
                        </ng-template>
                    </ngx-datatable-column>

                    <ngx-datatable-column name="Account">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <input matInput placeholder="Account" [(ngModel)]="row.account">
                        </ng-template>
                    </ngx-datatable-column>

                </ngx-datatable>
            </div>
        </mat-expansion-panel>

        <!-- Major Group Mapping -->
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Major Group Mapping
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="back" style="margin-bottom: 15px;">
                <button mat-flat-button (click)="openMajorGroupDialog()">Add</button>
            </div>

            <div>
                <mat-form-field class="example-full-width">
                    <mat-select matInput id="GrossDiscountSales" name="GrossDiscountSales" placeholder="Sync sales gross/gross less discount" 
                    [(ngModel)]="syncJobType.configuration.salesConfiguration.grossDiscountSales">
                        <mat-option value="Gross">Gross</mat-option>
                        <mat-option value="Gross Less Discount">Gross Less Discount</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div *ngIf="majorGroups?.length > 0">

                <ngx-datatable class="material" [rows]="majorGroups" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="50" [scrollbarV]="true" [scrollbarH]="true" 
                [sortType]="'multi'">

                    <ngx-datatable-column name="Major Group">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <mat-checkbox class="example-margin" [(ngModel)]="row.checked" *ngIf="row.majorGroup">{{row.majorGroup}}</mat-checkbox>
                        </ng-template>
                    </ngx-datatable-column>

                    <ngx-datatable-column name="Account">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <input matInput placeholder="Account" [(ngModel)]="row.account">
                        </ng-template>
                    </ngx-datatable-column>

                    <ngx-datatable-column name="Major Group Childs Count">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            {{row.children.length}}
                        </ng-template>
                    </ngx-datatable-column>
            
                    <ngx-datatable-column name="View Major Group Childs">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <button mat-flat-button (click)="viewMajorGroupChildsDialog(row)">View</button>
                        </ng-template>
                    </ngx-datatable-column>

                </ngx-datatable>
            </div>
        </mat-expansion-panel>

        <!-- Discount Mapping -->
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Discount Mapping
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="back" style="margin-bottom: 15px;">
                <button mat-flat-button (click)="openDiscountDialog()">Add</button>
                <mat-checkbox class="example-margin" [(ngModel)]="syncJobType.configuration.salesConfiguration.MGDiscount">Include Major Group Discount</mat-checkbox>
            </div>

            <div *ngIf="discounts?.length > 0">

                <ngx-datatable class="material" [rows]="discounts" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="50" [scrollbarV]="true" [scrollbarH]="true"
                [sortType]="'multi'">

                    <ngx-datatable-column name="Discount">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <mat-checkbox class="example-margin" [(ngModel)]="row.checked" *ngIf="row.discount">{{row.discount}}</mat-checkbox>
                        </ng-template>
                    </ngx-datatable-column>

                    <ngx-datatable-column name="Account">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <input matInput placeholder="Account" [(ngModel)]="row.account">
                        </ng-template>
                    </ngx-datatable-column>

                </ngx-datatable>
            </div>
        </mat-expansion-panel>

        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Service Charge Mapping
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="back" style="margin-bottom: 15px;">
                <button mat-flat-button (click)="openServiceChargeDialog()">Add</button>
            </div>

            <div *ngIf="serviceCharges?.length > 0">

                <ngx-datatable class="material" [rows]="serviceCharges" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="50" [scrollbarV]="true" [scrollbarH]="true"
                [sortType]="'multi'">

                    <ngx-datatable-column name="Service Charge">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <mat-checkbox class="example-margin" [(ngModel)]="row.checked" *ngIf="row.serviceCharge">{{row.serviceCharge}}</mat-checkbox>
                        </ng-template>
                    </ngx-datatable-column>

                    <ngx-datatable-column name="Account">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                            <input matInput placeholder="Account" [(ngModel)]="row.account">
                        </ng-template>
                    </ngx-datatable-column>

                </ngx-datatable>
            </div>
        </mat-expansion-panel>

        <br>
        <div class="card-back">
            <button mat-flat-button (click)="onSaveClick()">Save</button>
        </div>

    </div>

    <div *ngIf="!loading && !syncJobType">
        <mat-card class="example-card">
                <mat-card-header>
                    <mat-card-title>Welcome</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <p>
                        Can't Configure your sync right now, Please try again after few minutes.
                    </p>
                </mat-card-content>
        </mat-card>
    </div>
    <ngx-spinner></ngx-spinner>
</div>