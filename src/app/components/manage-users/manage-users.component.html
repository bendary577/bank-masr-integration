<div *ngIf="usersList.usersData.length != 0 || usersList.showLoading" class="header" style="margin: 15px;">
    <!-- <button mat-flat-button class="button-back" (click)="refresh()">Refresh</button> -->

    <button mat-flat-button (click)="addUserDialog()">Add Guest</button>
    <button mat-flat-button (click)="updateUserDialog()" [disabled]="validateUpdateUser()">Update Guest</button>
    <button mat-flat-button (click)="resendQRCode()" [disabled]="usersList.selected.length != 1">Resend QR Code</button>
    <button mat-flat-button (click)="deleteUsers('true')" [disabled]="validateDeleteUsers()">Delete Guest</button>
    <button mat-flat-button (click)="deleteUsers('false')" [disabled]="validateRestoreUsers()">Restore Guest</button>
</div>

<div class="filter-container" *ngIf="usersList.usersData.length != 0 || usersList.showLoading">
    <div class="filter-title">
        <span style="display: inline-block; font-size: 20px; font-weight: bold; color: black;">Filter Guest</span>
    </div>
    <div class="filter-buttons">

        <!-- <div class="five-column" style="width:16%;" > 
            <span style="font-family: fantasy; font-weight: 50; font-size: 12px;">From</span>
            <input matInput placeholder="Start Date" type="date" name="fromDate" id="fromDate" [(ngModel)]="fromDate" style="  border: 2px solid rgb(197, 197, 197);
            width: 160px;
            height: 32px;
            border-radius: 5px;
            left:auto;">
        </div>        

        <div class="five-column" style="width:16%;"> 
            <span style="font-family: fantasy; font-weight: 50; font-size: 12px;">To</span>
            <input matInput placeholder="End Dateu" type="date" name="toDate" id="toDate" [(ngModel)]="toDate" style="  border: 2px solid rgb(197, 197, 197);
            width: 160px;
            height: 32px;
            border-radius: 5px;
            left:auto;">
        </div>   -->

        <div class="five-column">
            <select class="custom-select" (change)="filterByGuestName()" [(ngModel)]="selectedGuest">
                <option value="" selected style="display:none">From</option>
                <option value=""></option>
                <option value="01111111111">0111111111</option>
                <option value="02222222222">0222222222</option>
                <!-- {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  -->
            </select>
        </div>

        <div class="five-column">
            <select class="custom-select" (change)="filterByGuestName()" [(ngModel)]="selectedGuest">
                <option value="" selected style="display:none">To</option>
                <option value=""></option>
                <option value="01111111111">0111111111</option>
                <option value="02222222222">0222222222</option>
                <!-- {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  -->
            </select>
        </div>

        <div class="five-column">
            <select class="custom-select" (change)="filterByGuestName()" [(ngModel)]="selectedGuest">
                <option value="" selected style="display:none">Card Number</option>
                <option value=""></option>
                <option value="01111111111">0111111111</option>
                <option value="02222222222">0222222222</option>
                <!-- {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  -->
            </select>
        </div>

        <div class="five-column">
            <select class="custom-select" (change)="filterByGuestName()" [(ngModel)]="selectedGuest">
                <option value="" selected style="display:none">Guest Name</option>
                <option value=""></option>
                <option value="Test user">Test user</option>
                <option value="New Test">New Test</option>
                <!-- {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  -->
            </select>
        </div>

        <div class="five-column">
            <select class="custom-select">
                <option value="" selected style="display:none">Card Statues</option>
                <option value=""></option>
                <option>Active</option>
                <option>Expired</option>
                <!-- {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  -->
            </select>
        </div>
        <div class="five-column">
            <select class="custom-select" (change)="filterByGuestName()" [(ngModel)]="selectedGuest">
                <option value="" selected style="display:none">Group</option>
                <option value=""></option>
                <option value="Test user">Test user</option>
                <option value="New Test">New Test</option>
                <!-- {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  -->
            </select>
        </div>
        <!-- <div class="five-column">
            <input matInput placeholder="Search Key Word...">
            <option value="" disabled selected>Guest Name</option>
                <option >Ahmed</option>
                     {{job.creationDate}} - {{job.status}}</option> [ngValue]="job" *ngFor="let job of jobs" (change)="getSyncJobData()" [(ngModel)]="selectedJob"  
            </select> 
        </div> -->
    </div>
    <div class="filter-view" *ngIf="guestNames.length">

        <div class="filter-item" [ngStyle]="styleProps" *ngFor="let name of guestNames">
            <!-- <span matBadge="5" matBadgeOverlap="false">Text with a badge</span> -->
            {{name}}
        </div>

        <!-- <div class="filter-item" [ngStyle]="props2">
         Nisantasi
        </div>
        <div class="filter-item" [ngStyle]="props2">
        Mcdonald's
        </div> -->
    </div>
</div>

<div class="main">

    <div *ngIf="usersList.usersData.length == 0 && !usersList.showLoading" style="text-align: center;">
        <img style="max-width: 300px; margin-top: 100px;" src="../../../assets/no-user.png" alt="image">
        <p class="user-name">You haven't added any users yet!</p>
        <button mat-flat-button (click)="addUserDialog()">ADD USERS</button>
    </div>

    <div *ngIf="usersList.usersData.length != 0 || usersList.showLoading">
        <ngx-datatable class="material" [loadingIndicator]="usersList.showLoading" [messages]="usersList.messages"
            [sortType]="'multi'" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="50"
            [scrollbarV]="true" [scrollbarH]="true" [rows]="usersList.usersData" [selected]="usersList.selected"
            [selectionType]="'checkbox'" [selectAllRowsOnPage]="false" (select)='onSelect($event)' [scrollbarH]="true">

            <ngx-datatable-column [sortable]="false" [canAutoResize]="false" [draggable]="false" [resizeable]="true" style="width:10px ;">
                <ng-template ngx-datatable-header-template let-value="value" let-allRowsSelected="allRowsSelected"
                    let-selectFn="selectFn">
                    <input class="regular-checkbox" type="checkbox" [checked]="allRowsSelected"
                        (change)="selectFn(!allRowsSelected)" />
                </ng-template>

                <ng-template ngx-datatable-cell-template let-value="value" let-isSelected="isSelected"
                    let-onCheckboxChangeFn="onCheckboxChangeFn">
                    <input class="regular-checkbox" type="checkbox" [checked]="isSelected"
                        (change)="onCheckboxChangeFn($event)" />
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Card Number">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <div style="float: left;"><img class="profile-img" src="../../../assets/profile.png" alt="image">
                    </div>
                    <div style="float: left; color: black; margin-top: 3px; margin-left: 5px;">{{row.cardNumber}}</div>
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Name">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <div *ngIf="row.deleted">
                        {{row.name}}
                    </div>
                    <div *ngIf="!row.deleted">
                        <a class="group-name" (click)="openUserProfile(row)">{{row.name}}</a>
                    </div>
                </ng-template>
            </ngx-datatable-column>

            <!-- <ngx-datatable-column name="Email">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{row.email}}
                </ng-template>
            </ngx-datatable-column> -->

            <ngx-datatable-column name="Mobile">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <!-- {{row.group.name}} -->
                    {{row.mobile}}
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Group">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <!-- {{row.group.name}} -->
                    Generic
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Balance">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{row.palance}} USD
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Number Of Accompanied Guest">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{row.accompanied}} 
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Expires In">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{row.expiration}} Hour
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Discount Rate">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <!-- <label *ngIf="row.group.name != ''">{{row.group.simphonyDiscount.discountRate}} %</label> -->
                    0 %
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="State">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <label *ngIf="!row.statues" class="active-state">{{row.deleted}}</label>
                    <label *ngIf="row.statues" class="deleted-state">{{row.deleted}}</label>
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Creation Time">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{row.creationDate | date: 'dd/MM/yyyy HH:mm:ss' }}
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Last Update">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    {{row.lastUpdate | date: 'dd/MM/yyyy HH:mm:ss' }}
                </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name=" ">
                <ng-template let-row="row" ngx-datatable-cell-template>
                    <button class="menue-btn" mat-button [matMenuTriggerFor]="menu">. . . </button>
                    <mat-menu  #menu="matMenu">
                      <button class="menue-btn-choi" mat-menu-item>Suspend</button>
                      <button class="menue-btn-choi" mat-menu-item>Delete</button>
                      <button class="menue-btn-choi" mat-menu-item>Cancel</button>
                      <button class="menue-btn-choi" mat-menu-item (click)="openUserProfile(row)">Preview</button>
                    </mat-menu>
                </ng-template>
            </ngx-datatable-column>
        </ngx-datatable>
    </div>
</div>